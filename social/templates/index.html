{%  extends "base.html" %}
{% block page_style %}
{% block title %} Dashboard {% endblock %}
{% endblock %}
{% block content %}
    <div class="row allPosts">
    </div>
    {% verbatim %}
        <script id="post_template" type="text/template">
            <div class="col-xs-4 pull-left posts" data-filter="{{ url }} {{ image }} {{ description }} {{ username }} {{ datetime }} {{ tags }}">
                <a href="{{ url }}">
                    <img src="{{ image }}" class="img-responsive" alt=""/>
                </a>
                <h5>{{ description }}</h5>
                <h6><a href="/users/{{ username }}">{{ username }}</a> on {{ datetime}}</h6>
                <h6 style="font-weight: bold;">tags: {{ tags }}</h6>
                <button class="pin" data-pk="{{  pk  }}">PIN
                </button>
            </div>
        </script>
    {% endverbatim %}
{% endblock %}
{% block js %}
        $(document).ready(function(){
            $.getJSON('/content/', function(data){
                $.each(data, function(key,val){
                    var data1 = val.url;
                    var template = $('#post_template').html();
                    var html = Mustache.to_html(template, val);
                    $('.allPosts').append(html);
               });
            });
            $(document).on('click', ".pin", function(e) { 
                var $target = $(e.target);
                var params={pk: $target.data("pk")};
                $.post('/pin/', params, function(data) { 
                    if(data.success == "true"){
                        $target.text('PINNED').removeClass('pin').addClass('pinned');
                    }

                }, "json");

            });

        });



{% endblock %}